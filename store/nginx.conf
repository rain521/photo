server {
    # 监听 80 端口（HTTP）和可选的 443 端口（HTTPS，需配置SSL证书）
    listen 80;
    # listen 443 ssl http2; # 启用HTTPS时取消注释
    # ssl_certificate /path/to/your/cert.pem;
    # ssl_certificate_key /path/to/your/key.pem;

    # 将 your_domain.com 替换为你的域名。
    # 如果没有域名，就填你的服务器公网IP（例如 139.224.101.218），或者用下划线 _ 代表所有。
    server_name http://www.cytp.cc;

    # 指定我们上传的静态文件的根目录
    root /home/store;
    index index.html;

    # 支持 Vue Router 的 history 模式（核心配置）
    # 所有非静态文件请求都回退到 index.html，由前端路由处理
    location / {
        try_files $uri $uri/ /index.html;
    }

    # 代理后端 API 请求（如果你的前端需要调用 Nest.js 等后端服务）
    # 假设你的后端运行在 3000 端口
    location /api/ {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # 静态资源缓存优化（提升加载速度）
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y; # 缓存1年
        add_header Cache-Control "public, immutable";
        add_header Access-Control-Allow-Origin *; # 处理字体等资源跨域
        try_files $uri =404; # 防止找不到资源时回退到 index.html
    }

    # 禁止访问隐藏文件（如 .git, .env）
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }

    # 自定义错误页面（可选）
    error_page 404 /index.html;
    # error_page 500 502 503 504 /50x.html;
    # location = /50x.html {
    #     root /usr/share/nginx/html;
    # }
}